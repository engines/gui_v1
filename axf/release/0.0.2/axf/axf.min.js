"use strict";let ax=function(e,t){t&&(e instanceof Array||(e=[e]),e={$nodes:e,...t});let r=ax.factory(e);e.id?document.querySelector("#"+e.id).replaceWith(r):document.body.appendChild(r)};ax.extension={},ax.css=function(e,t={}){return ax.insert("head","style",this.css.styles(e),{tag:t.styleTag}),null},ax.tag={},ax.kebab=function(e){return(e[0].match(/[A-Z]/)?"-":"")+e.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase()},ax.insert=function(e,t,r,n={}){let o=n.method||"appendChild";var s=document.createElement(t);Object.assign(s,n.tag);var i=document.querySelector(e);s.innerHTML=r,i[o](s)},ax["throw"]=function(...e){throw new Error(e)},ax.log=((...e)=>(console.log.bind(console)(...e),null)),ax.factory=function(e){let t=ax.is,r=ax.factory;return t["null"](e)?null:t.node(e)?e:t.nodelist(e)?r.nodelist(e):t.array(e)?r.array(e):t.promise(e)?r.promise(e):t.object(e)?r.object(e):t["class"](e)?r["class"](e):t.tag(e)?r.tag(e):t["function"](e)?r["function"](e):(t.undefined(e)&&r.undefined(),r.text(e))},ax.is={},ax.log.info=((...e)=>{console.info.bind(console)(...e)}),ax.log.error=((...e)=>{console.error.bind(console)(...e)}),ax.log.warn=((...e)=>{console.warn.bind(console)(...e)}),ax.is.not=new Proxy({},{get:(e,t)=>{if(ax.is["function"](ax.is[t]))return e=>!ax.is[t](e);ax.log.error(`ax.is does not support .${t}()`)}}),ax.is["false"]=function(e){return!1===e},ax.is.undefined=function(e){return void 0===e},ax.is.object=function(e){return"object"==typeof e},ax.is.promise=function(e){return e instanceof Promise},ax.is["null"]=function(e){return null===e},ax.is.tag=function(e){return""+ax.a.tagProxyFunction==""+e},ax.is.number=function(e){return"number"==typeof e},ax.is.nodelist=function(e){return e instanceof NodeList},ax.is.boolean=function(e){return typeof e===boolean},ax.is.array=function(e){return e instanceof Array},ax.is["function"]=function(e){return"function"==typeof e},ax.is["class"]=function(e){return this["function"](e)&&"class"===(""+e).slice(0,5)},ax.is.node=function(e){return e instanceof Node},ax.is.string=function(e){return"string"==typeof e},ax.is["true"]=function(e){return!0===e},ax.x=ax.extension,ax.factory.undefined=function(){ax["throw"]("Component is undefined.")},ax.factory.text=function(e){return document.createTextNode(" "+e+" ")},ax.factory.object=function(e){return this.element({$tag:"pre",$text:JSON.stringify(e,null,2)})},ax.factory.promise=function(e){return this.element({$init:t=>{e.then(function(...e){t.$nodes=ax.factory(e)})["catch"](function(...e){t.$nodes=ax.factory(e)})}})},ax.factory.tag=function(e){return this.element(e())},ax.factory.nodelist=function(e){return this.element({$nodes:Array.from(e)})},ax.factory.element=function(e){e={$tag:"span",...e};let t=document.createElement(e.$tag);return t.$properties=e,this.element.properties.init(this.element.properties(t).$render())},ax.factory.array=function(e){return this.element({$tag:"div",$nodes:e})},ax.factory["function"]=function(e){return this(e(ax.a,ax.x))},ax.factory["class"]=function(e){const t=ax.a,r=ax.x;return this.element(new e(t,r))},ax.tag.proxy={},ax.tag.collection={},ax.css.styles=function(e){return ax.is.string(e)?e:this.styles.rules(e)},ax.factory.element.properties=function(e){return this.properties.render(this.properties.events(this.properties.accessors(this.properties.tools(this.properties.define(e)))))},ax.factory.element.append=function(e,t){let r=ax.factory(t);ax.is.array(r)?r.forEach(function(t){e.appendChild(t)}):e.appendChild(r)},ax.tag.collection.proxy=(()=>new Proxy(ax.tag.collection["function"],ax.tag.collection.shim)),ax.tag.proxy.shim={get:(e,t)=>"$$"===t?ax.tag.collection.proxy():function(e=null,r={}){return e=ax.tag.proxy.shim.component(e),r=ax.tag.proxy.shim.attributes(t,r),ax.factory.element({...e,...r})}},ax.tag.proxy["function"]=function(e){if(ax.is.string(e)){let t=document.createElement("div");return t.innerHTML=e,t.childNodes}if(ax.is.object(e))return ax.factory.element(e);ax.log.error("Component must be String or Object.")},ax.css.styles.rules=function(e,t=[]){if(t[0]&&"@"==t[0][0])return ax.css.styles.rules.at(e,t);if(ax.is.array(e))return"?";if(ax.is.object(e)){let r=ax.css.styles.rules.rule(e,t);return Object.keys(e).forEach(function(n){var o=e[n];n.split(",").forEach(function(e){e=e.trim(),r+=ax.css.styles.rules(o,t.concat(e))})}),r}return""},ax.factory.element.properties.accessors=function(e){return this.accessors.nodes(this.accessors.html(this.accessors.text(this.accessors.on(this.accessors.off(this.accessors.send(this.accessors.state(e)))))))},ax.factory.element.properties.render=function(e){let t=this.render;return e.$render=function(){return e.$properties.hasOwnProperty("$text")?t.text(e):e.$properties.hasOwnProperty("$html")?t.html(e):e.$properties.hasOwnProperty("$nodes")?t.nodes(e):e},e},ax.factory.element.properties.traverse=function(e,t){return e?/^\s*\^/.test(t)?(t=t.replace(/^\s*\^\s*/,""))?e.closest(t):e.parentElement:/^\s*$/.test(t)?e:e.querySelector(t):null},ax.factory.element.properties.init=function(e){return ax.is["function"](e.$properties.$init)&&e.appendChild(ax.factory.element({$tag:"script",type:"text/javascript",$html:"(function(){let script=document.currentScript;let element=script.parentElement;script.remove();element.$init( element, element.$state );})()"})),e},ax.factory.element.properties.tools=function(e){return e.$=this.traverse.$,e.$$=this.query.$$,e},ax.factory.element.properties.events=function(e){if(e.$properties.hasOwnProperty("$on"))for(let t in e.$properties.$on)e.addEventListener(t.split(":")[0],function(r){e.$properties.$on[t]&&e.$properties.$on[t].call(this,r,e,e.$state)});return e},ax.factory.element.properties.query=function(e,t=[]){return new Proxy(function(){},this.query.proxy.shim(e,t))},ax.factory.element.properties.define=function(e){for(let t in e.$properties)if(e.$properties.hasOwnProperty(t))if(/[a-zA-Z]/.test(t[0])){let r=e.$properties[t];ax.is.not.undefined(r)&&("data"==t?this.define.data(e,r):"style"==t?this.define.style(e,r):this.define.attribute(e,t,r))}else"$text"!=t&&"$nodes"!=t&&"$html"!=t&&"$state"!=t&&"$send"!=t&&"$on"!=t&&"$off"!=t&&(e[t]=e.$properties[t]);return e},ax.tag.collection.shim={get:(e,t)=>(function(...e){return e.map(function(e){return ax.a[t](e)})})},ax.tag.collection["function"]=(()=>{}),ax.tag.proxy.shim.component=function(e){let t=ax.is;return t.node(e)?{$nodes:[e]}:t.nodelist(e)?{$nodes:[Array.from(e)]}:t.array(e)?{$nodes:e}:t.object(e)?e:t["function"](e)?{$nodes:[e]}:(t.undefined(e)&&ax.factory.undefined(),{$text:e})},ax.tag.proxy.shim.attributes=function(e,t){let r=(e.match(/^([\w|-]+)/)||[])[1],n=(e.match(/#([\w|-]+)/)||[])[1],o=(e.match(/\.([\.|\w|-]+)/)||[])[1];return r&&(t.$tag=r),n&&(t.id=n),o&&(t["class"]=o.replace(/\./g," ")),t},ax.a=new Proxy(ax.tag.proxy["function"],ax.tag.proxy.shim),ax.css.styles.rules.rule=function(e,t){var r="";return Object.keys(e).forEach(function(t){ax.is.object(e[t])||(r+="\t"+ax.kebab(t)+": "+e[t]+";\n")}),""===r?r:t.join(" ").replace(/\s*&\s*/g,"")+" {\n"+r+"}\n"},ax.css.styles.rules.at=function(e,t){let r=t.shift(),n=this.rules(e,t);return`${r} {\n${n="\t"+n.split("\n").join("\n\t")}\n}\n\n`},ax.factory.element.properties.render.text=function(e){let t=e.$text;for(ax.is["function"](t)&&(t=t.bind(e));e.childNodes.length;)e.removeChild(e.lastChild);return e.appendChild(document.createTextNode(t)),e},ax.factory.element.properties.render.html=function(e){let t=e.$html;return ax.is["function"](t)&&(t=t.bind(e)),e.innerHTML=t,e},ax.factory.element.properties.render.nodes=function(e){let t=e.$nodes;for(ax.is["function"](t)&&(t=t.bind(e),e.$properties.hasOwnProperty("$state")&&(t=t(e,e.$state)));e.firstChild;)e.firstChild.remove();if(ax.is.array(t))t.forEach(function(t){null!=(t=ax.factory(t))&&e.appendChild(t)});else{let r=ax.factory(t);null!=r&&e.appendChild(r)}return e},ax.factory.element.properties.query.$$=function(e){return ax.factory.element.properties.query(Array.from(this.querySelectorAll(e)))},ax.factory.element.properties.query.proxy={},ax.factory.element.properties.traverse.$=function(...e){let t=this;return e.forEach(function(e){if(ax.is.array(e))t=t.$(...e);else if(/^\^\S*$/.test(e))t=ax.factory.element.properties.traverse(t,e);else if(/,\s*/.test(e)){let r,n=e.split(/,\s*/);for(let e in n)if(r=ax.factory.element.properties.traverse(t,n[e]))break;t=r}else/\^/.test(e)?(e=e.split(/(\^\S*)/g),t=t.$(...e)):t=ax.factory.element.properties.traverse(t,e)}),t},ax.factory.element.properties.accessors.text=function(e){let t=this;return Object.defineProperty(e,"$text",{get:function(){return e.$properties.$text},set:function(r){t.text.set(e,r)}}),e},ax.factory.element.properties.accessors.html=function(e){let t=this;return Object.defineProperty(e,"$html",{get:function(){return e.$properties.$html},set:function(r){t.html.set(e,r)}}),e},ax.factory.element.properties.accessors.state=function(e){let t=this;return Object.defineProperty(e,"$state",{get:function(){return e.$properties.$state},set:function(r){t.state.set(e,r)}}),e},ax.factory.element.properties.accessors.send=function(e){return e.$send=function(t,r={}){return e.dispatchEvent(new CustomEvent(t,{detail:r.detail||{},bubbles:0!=r.bubbles,cancelable:0!=r.cancelable}))},e},ax.factory.element.properties.accessors.on=function(e){return Object.defineProperty(e,"$on",{get:function(){return e.$properties.$on},set:function(t){e.addEventListener(t.split(":")[0],function(r){e.$properties.$on[t]&&e.$properties.$on[t].call(this,r,e,e.$state)})}}),e},ax.factory.element.properties.accessors.nodes=function(e){let t=this;return Object.defineProperty(e,"$nodes",{get:function(){return e.$properties.$nodes},set:function(r){t.nodes.set(e,r)}}),e},ax.factory.element.properties.accessors.off=function(e){return e.$off=function(t){e.removeEventListener(t.split(":")[0],e.$properties.$on[t])},e},ax.factory.element.properties.define.style=function(e,t){if(ax.is.object(t)){let r="";Object.keys(t).forEach(function(e){let n=ax.kebab(e);r+=n+": "+t[e]+"; "}.bind(this)),this.attribute(e,"style",r)}else this.attribute(e,"style",t)},ax.factory.element.properties.define.attribute=function(e,t,r){let n=document.createAttribute(t);n.value=r,e.setAttributeNode(n)},ax.factory.element.properties.define.data=function(e,t){ax.is.object(t)?this.data.attribute(e,["data"],t):this.attribute(e,"data",value)},ax.factory.element.properties.query.proxy.shim=function(e,t){return{get:ax.factory.element.properties.query.proxy.shim.get(e,t),set:ax.factory.element.properties.query.proxy.shim.set(e,t),apply:ax.factory.element.properties.query.proxy.shim.apply(e,t)}},ax.factory.element.properties.accessors.state.set=function(e,t){if(e.$properties.$state!==t)return e.$properties.$state=t,e.$properties.$update?e.$properties.$update.call(e,e,t)&&e.$render():e.$render(),e},ax.factory.element.properties.accessors.text.set=function(e,t){return delete e.$properties.$html,delete e.$properties.$nodes,e.$properties.$text=t,e.$render(),e},ax.factory.element.properties.accessors.on.set=function(e,t){for(let r in t)e.$off(r),e.$properties.$on[r]=t[r],e.addEventListener(r.split(":")[0],e.$properties.$on[r]);return e},ax.factory.element.properties.accessors.nodes.set=function(e,t){return delete e.$properties.$text,delete e.$properties.$html,e.$properties.$nodes=t,e.$render(),e},ax.factory.element.properties.accessors.html.set=function(e,t){return delete e.$properties.$text,delete e.$properties.$nodes,e.$properties.$html=t,e.$render(),e},ax.factory.element.properties.define.data.attribute=function(e,t,r){let n=ax.factory.element.properties.define;if(ax.is.string(r)){let o=t.join("-");n.attribute(e,o,r)}else Object.keys(r).forEach(function(o){n.kebab(o);this.attribute(e,t.concat(o),r[o])}.bind(this))},ax.factory.element.properties.query.proxy.shim.get=function(e,t){return function(r,n){return/^\d+$/.test(n)?e[n]:/^\$\$$/.test(n)?e:/^toArray$/.test(n)?()=>e:/^toString$/.test(n)?()=>e.toString:(e.forEach(function(r,o){let s=r[n];ax.is.undefined(s)?ax.log.error(`Ax query for ${n} is undefined for:`,r):ax.is["function"](s)?t[o]=s:e[o]=s}),ax.factory.element.properties.query(e,t))}},ax.factory.element.properties.query.proxy.shim.set=function(e){return function(t,r,n){return e.forEach(function(e){e[r]=n}),!0}},ax.factory.element.properties.query.proxy.shim.apply=function(e,t){return function(r,n,o){return e.forEach(function(r,n){e[n]=t[n].call(r,...o)}),ax.factory.element.properties.query(e)}};